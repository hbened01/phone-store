{"version":3,"sources":["webpack:///./routes/pdp/style.css","webpack:///./routes/pdp/index.js"],"names":["Pdp","_ref","id","_useState2","_slicedToArray","useState","productDetail","setProducDetail","productsDetailData","useRef","_useContext","useContext","Context","setCartListStorage","setNotify","current","JSON","parse","window","localStorage","getItem","useEffect","_productsDetailData$c","_productsDetailData$c2","isMatchIndex","findIndex","_ref2","productId","getTime","Date","timeControl","getProductByIdPdp","then","data","addHours","newDataForStorage","concat","_toConsumableArray","dataProduct","setItem","stringify","catch","error","prevState","_objectSpread","type","message","isNotify","finally","setTimeout","_productsDetailData$c3","h","Fragment","isObjectEmpty","className","style","pdp","Image","wrapperClass","delayTime","effect","imgUrl","PdpDescription","PdpAction","_extends","handleAddProductToCart","product","postToCart","newCartListData","Object","values","reduce","a","p","colorCode","storageCode","route","Loader"],"mappings":"2FACe,KAAC,IAAM,a,2/FC6IPA,UApIH,SAAHC,GAAe,IAATC,EAAED,EAAFC,GACwCC,EAAAC,EAAZC,YAAS,CAAC,GAAE,GAA9CC,EAAaH,EAAA,GAAEI,EAAeJ,EAAA,GAC/BK,EAAqBC,YAAO,MAClCC,EAA0CC,YAAWC,KAA7CC,EAAkBH,EAAlBG,mBAAoBC,EAASJ,EAATI,UAG5BN,EAAmBO,QAAUC,KAAKC,MAChCC,OAAOC,aAAaC,QAAQ,+BA2F9B,OAnDAC,aAAU,WAAM,IAAAC,EAAAC,EAERC,EAAyC,QAA7BF,EAAGd,EAAmBO,eAAO,IAAAO,OAAA,EAA1BA,EAA4BG,WAC/C,SAAAC,GAAY,OAAAA,EAATC,YAA8BzB,CAAE,KAGlCM,EAAmBO,UACF,IAAlBS,GACAI,YAAQ,IAAIC,OAC8B,QADvBN,EACjBf,EAAmBO,QAAQS,UAAa,IAAAD,OAAA,EAAxCA,EAA0CO,aAE5CC,YAAkB7B,GACf8B,MAAK,SAACC,GACL,IAAMH,EAAcF,YAAQM,YAAS,IAAIL,KAAQ,IAC3CM,EAAoB,GAAHC,OAAAC,EACjB7B,EAAmBO,SAAW,IAC/B,CACD,CACEe,cACAH,UAAWzB,EACXoC,YAAaL,KAKnBf,OAAOC,aAAaoB,QAClB,6BACAvB,KAAKwB,UAAUL,IAGjB5B,EAAgB0B,EAClB,IACCQ,OAAM,SAACC,GAEN5B,GAAU,SAAC6B,GAAS,OAAAC,IAAA,GACfD,GACA,CACDE,KAAM,SACNC,QAASJ,EAAMI,QACfC,UAAU,GACX,GAEL,IACCC,SAAQ,WAAO,IAGpBC,YAAW,WAAM,IAAAC,EAEf3C,EAAwD,QAAzC2C,EAAC1C,EAAmBO,QAAQS,UAAa,IAAA0B,OAAA,EAAxCA,EAA0CZ,YAC5D,GAAG,IACL,GAAG,CAACpC,EAAIY,IAENqC,YAAAC,EAAA,MACIC,YAAc/C,IACd6C,YAAA,OAAKG,UAAWC,IAAMC,KACpBL,YAAA,eACEA,YAAA,OAAKG,UAAU,uBACbH,YAAA,OAAKG,UAAU,0CACbH,YAACM,IAAK,CAEFC,aACE,6DACFC,UAAW,IACXC,OAAQ,OACRC,QAAQvD,aAAa,EAAbA,EAAeuD,SAAU,GACjC3D,IAAII,aAAa,EAAbA,EAAeJ,KAAM,KAG7BiD,YAAA,OAAKG,UAAU,iDACbH,YAACW,IAAmBxD,GACpB6C,YAACY,IAASC,EAAA,CACRC,uBA3Ga,SAACC,GAC9BC,YAAWD,GACRlC,MAAK,WAEJnB,GAAmB,SAAC8B,GAClB,IAAMyB,EAAkBC,OAAOC,OAC7B,GAAAlC,OAAAC,EAAIM,GAAS,CAAEuB,IAASK,QAAO,SAACC,EAAGC,GAEjC,OADAD,EAAE,GAADpC,OAAIqC,EAAEvE,GAAE,KAAAkC,OAAIqC,EAAEC,UAAS,KAAAtC,OAAIqC,EAAEE,cAAiBF,EACxCD,CACT,GAAG,CAAC,IAON,OAJAtD,OAAOC,aAAaoB,QAClB,kBACAvB,KAAKwB,UAAU4B,IAEVA,CACT,GACF,IACC3B,OAAM,SAACC,GAEN5B,GAAU,SAAC6B,GAAS,OAAAC,IAAA,GACfD,GACA,CACDE,KAAM,SACNC,QAASJ,EAAMI,QACfC,UAAU,GACX,GAEL,IACCC,SAAQ,WAEP4B,gBAAM,IACR,GACJ,GA0EsBtE,SAQjB+C,YAAc/C,IAAkB6C,YAAC0B,IAAM,MAG9C,C","file":"route-pdp.chunk.84056.js","sourcesContent":["// extracted by mini-css-extract-plugin\nexport default {\"pdp\":\"pdp__STo3Y\"};","import { h } from \"preact\";\nimport { useEffect, useState, useRef, useContext } from \"preact/hooks\";\nimport { route } from \"preact-router\";\nimport { addHours, getTime } from \"date-fns\";\nimport { getProductByIdPdp, postToCart } from \"@/services\";\nimport { Image, PdpAction, PdpDescription, Loader } from \"@/components/\";\nimport { isObjectEmpty } from \"@/utils\";\nimport { Context } from \"@/contexts\";\nimport style from \"./style.css\";\n\nconst Pdp = ({ id }) => {\n  const [productDetail, setProducDetail] = useState({});\n  const productsDetailData = useRef(null);\n  const { setCartListStorage, setNotify } = useContext(Context);\n\n  // GET DATA FROM LOCAL STORAGE:\n  productsDetailData.current = JSON.parse(\n    window.localStorage.getItem(\"DATA_PRODUCTS_DETAIL_STORE\")\n  );\n\n  // ADD PRODUCT TO CART SERVICE:\n  const handleAddProductToCart = (product) => {\n    postToCart(product)\n      .then(() => {\n        // SET AND GET UNIQUE VALUES\n        setCartListStorage((prevState) => {\n          const newCartListData = Object.values(\n            [...prevState, product].reduce((a, p) => {\n              a[`${p.id}|${p.colorCode}|${p.storageCode}`] = p;\n              return a;\n            }, {})\n          );\n          // SET LIST DATA CART INTO LOCAL STORAGE:\n          window.localStorage.setItem(\n            \"DATA_CART_ITEMS\",\n            JSON.stringify(newCartListData)\n          );\n          return newCartListData;\n        });\n      })\n      .catch((error) => {\n        // SET NOTIFY:\n        setNotify((prevState) => ({\n          ...prevState,\n          ...{\n            type: \"danger\",\n            message: error.message,\n            isNotify: true,\n          },\n        }));\n      })\n      .finally(() => {\n        // GO TO HOME:\n        route(`/`);\n      });\n  };\n\n  useEffect(() => {\n    // FIND INDEX OF PRODUCT:\n    const isMatchIndex = productsDetailData.current?.findIndex(\n      ({ productId }) => productId === id\n    );\n    if (\n      !productsDetailData.current ||\n      isMatchIndex === -1 ||\n      getTime(new Date()) >\n        productsDetailData.current[isMatchIndex]?.timeControl\n    ) {\n      getProductByIdPdp(id)\n        .then((data) => {\n          const timeControl = getTime(addHours(new Date(), 1)); // CONTROL EPISODE API TIME 1 HRS.\n          const newDataForStorage = [\n            ...(productsDetailData.current || []),\n            ...[\n              {\n                timeControl,\n                productId: id,\n                dataProduct: data,\n              },\n            ],\n          ];\n          // SET DATA IN LOCALSTORAGE:\n          window.localStorage.setItem(\n            \"DATA_PRODUCTS_DETAIL_STORE\",\n            JSON.stringify(newDataForStorage)\n          );\n          // SET DATA PRODUCT IN STATE:\n          setProducDetail(data);\n        })\n        .catch((error) => {\n          // SET NOTIFY:\n          setNotify((prevState) => ({\n            ...prevState,\n            ...{\n              type: \"danger\",\n              message: error.message,\n              isNotify: true,\n            },\n          }));\n        })\n        .finally(() => {});\n      return;\n    }\n    setTimeout(() => {\n      // SET DATA PRODUCT IN STATE:\n      setProducDetail(productsDetailData.current[isMatchIndex]?.dataProduct);\n    }, 500);\n  }, [id, setNotify]);\n  return (\n    <>\n      {!isObjectEmpty(productDetail) && (\n        <div className={style.pdp}>\n          <section>\n            <div className=\"px-10 py-10 mx-auto\">\n              <div className=\"mx-auto flex flex-wrap justify-between\">\n                <Image\n                  {...{\n                    wrapperClass:\n                      \"!flex flex-col justify-center items-center md:w-1/2 w-full\",\n                    delayTime: 1000,\n                    effect: \"blur\",\n                    imgUrl: productDetail?.imgUrl || \"\",\n                    id: productDetail?.id || \"\",\n                  }}\n                />\n                <div className=\"md:w-1/2 w-full lg:pl-10 lg:py-6 mt-6 lg:mt-0\">\n                  <PdpDescription {...productDetail} />\n                  <PdpAction\n                    handleAddProductToCart={handleAddProductToCart}\n                    {...productDetail}\n                  />\n                </div>\n              </div>\n            </div>\n          </section>\n        </div>\n      )}\n      {isObjectEmpty(productDetail) && <Loader />}\n    </>\n  );\n};\n\nexport default Pdp;\n"],"sourceRoot":""}
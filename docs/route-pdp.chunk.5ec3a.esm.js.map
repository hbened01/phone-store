{"version":3,"sources":["webpack:///./routes/pdp/style.css","webpack:///./routes/pdp/index.js"],"names":["Pdp","id","productDetail","setProducDetail","useState","productsDetailData","useRef","setCartListStorage","setNotify","useContext","Context","current","JSON","parse","window","localStorage","getItem","useEffect","_productsDetailData$c","_productsDetailData$c2","isMatchIndex","findIndex","productId","getTime","Date","timeControl","getProductByIdPdp","then","data","addHours","newDataForStorage","dataProduct","setItem","stringify","catch","error","prevState","_objectSpread","type","message","isNotify","route","PREACT_APP_PUBLIC_PATH","setTimeout","_productsDetailData$c3","h","Fragment","isObjectEmpty","className","style","pdp","Image","wrapperClass","delayTime","effect","imgUrl","PdpDescription","PdpAction","_extends","handleAddProductToCart","product","postToCart","newCartListData","Object","values","reduce","a","p","colorCode","storageCode","finally","Loader"],"mappings":"2FACe,KAAC,IAAM,a,06CC+IPA,UArIHA,EAAGC,SACb,MAAOC,EAAeC,GAAmBC,YAAS,CAAC,GAC7CC,EAAqBC,YAAO,OAC5B,mBAAEC,EAAkB,UAAEC,GAAcC,YAAWC,KAGrDL,EAAmBM,QAAUC,KAAKC,MAChCC,OAAOC,aAAaC,QAAQ,+BA4F9B,OApDAC,aAAU,KAAM,IAAAC,EAAAC,EAEd,MAAMC,EAAyC,QAA7BF,EAAGb,EAAmBM,eAAO,IAAAO,OAAA,EAA1BA,EAA4BG,WAC/C,EAAGC,eAAgBA,IAAcrB,KAGhCI,EAAmBM,UACF,IAAlBS,GACAG,YAAQ,IAAIC,OAC8B,QADvBL,EACjBd,EAAmBM,QAAQS,UAAa,IAAAD,OAAA,EAAxCA,EAA0CM,aAE5CC,YAAkBzB,GACf0B,MAAMC,IACL,MAAMH,EAAcF,YAAQM,YAAS,IAAIL,KAAQ,IAC3CM,EAAoB,IACpBzB,EAAmBM,SAAW,GAEhC,CACEc,cACAH,UAAWrB,EACX8B,YAAaH,IAKnBd,OAAOC,aAAaiB,QAClB,6BACApB,KAAKqB,UAAUH,IAGjB3B,EAAgByB,EAAK,IAEtBM,OAAOC,IAEN3B,GAAW4B,GAASC,IAAA,GACfD,GACA,CACDE,KAAM,SACNC,QAASJ,EAAMI,QACfC,UAAU,MAIdC,gBAAO,GAAEC,MAAyB,IAIxCC,YAAW,KAAM,IAAAC,EAEfzC,EAAwD,QAAzCyC,EAACvC,EAAmBM,QAAQS,UAAa,IAAAwB,OAAA,EAAxCA,EAA0Cb,YAAY,GACrE,IAAI,GACN,CAAC9B,EAAIO,IAENqC,YAAAC,EAAA,MACIC,YAAc7C,IACd2C,YAAA,OAAKG,UAAWC,IAAMC,KACpBL,YAAA,eACEA,YAAA,OAAKG,UAAU,uBACbH,YAAA,OAAKG,UAAU,0CACbH,YAACM,IAAK,CAEFC,aACE,6DACFC,UAAW,IACXC,OAAQ,OACRC,QAAQrD,aAAa,EAAbA,EAAeqD,SAAU,GACjCtD,IAAIC,aAAa,EAAbA,EAAeD,KAAM,KAG7B4C,YAAA,OAAKG,UAAU,iDACbH,YAACW,IAAmBtD,GACpB2C,YAACY,IAASC,EAAA,CACRC,uBA5GcC,IAC9BC,YAAWD,GACRjC,MAAK,KAEJpB,GAAoB6B,IAClB,MAAM0B,EAAkBC,OAAOC,OAC7B,IAAI5B,EAAWwB,GAASK,QAAO,CAACC,EAAGC,KACjCD,EAAG,GAAEC,EAAElE,MAAMkE,EAAEC,aAAaD,EAAEE,eAAiBF,EACxCD,IACN,CAAC,IAON,OAJApD,OAAOC,aAAaiB,QAClB,kBACApB,KAAKqB,UAAU6B,IAEVA,CAAe,GACtB,IAEH5B,OAAOC,IAEN3B,GAAW4B,GAASC,IAAA,GACfD,GACA,CACDE,KAAM,SACNC,QAASJ,EAAMI,QACfC,UAAU,KAEX,IAEJ8B,SAAQ,KAEP7B,gBAAO,GAAEC,MAAyB,GAClC,GA4EgBxC,SAQjB6C,YAAc7C,IAAkB2C,YAAC0B,IAAM,MACvC,C","file":"route-pdp.chunk.5ec3a.esm.js","sourcesContent":["// extracted by mini-css-extract-plugin\nexport default {\"pdp\":\"pdp__STo3Y\"};","import { h } from \"preact\";\nimport { useEffect, useState, useRef, useContext } from \"preact/hooks\";\nimport { route } from \"preact-router\";\nimport { addHours, getTime } from \"date-fns\";\nimport { getProductByIdPdp, postToCart } from \"@/services\";\nimport { Image, PdpAction, PdpDescription, Loader } from \"@/components/\";\nimport { isObjectEmpty } from \"@/utils\";\nimport { Context } from \"@/contexts\";\nimport { PREACT_APP_PUBLIC_PATH } from \"@/constants\";\nimport style from \"./style.css\";\n\nconst Pdp = ({ id }) => {\n  const [productDetail, setProducDetail] = useState({});\n  const productsDetailData = useRef(null);\n  const { setCartListStorage, setNotify } = useContext(Context);\n\n  // GET DATA FROM LOCAL STORAGE:\n  productsDetailData.current = JSON.parse(\n    window.localStorage.getItem(\"DATA_PRODUCTS_DETAIL_STORE\")\n  );\n\n  // ADD PRODUCT TO CART SERVICE:\n  const handleAddProductToCart = (product) => {\n    postToCart(product)\n      .then(() => {\n        // SET AND GET UNIQUE VALUES\n        setCartListStorage((prevState) => {\n          const newCartListData = Object.values(\n            [...prevState, product].reduce((a, p) => {\n              a[`${p.id}|${p.colorCode}|${p.storageCode}`] = p;\n              return a;\n            }, {})\n          );\n          // SET LIST DATA CART INTO LOCAL STORAGE:\n          window.localStorage.setItem(\n            \"DATA_CART_ITEMS\",\n            JSON.stringify(newCartListData)\n          );\n          return newCartListData;\n        });\n      })\n      .catch((error) => {\n        // SET NOTIFY:\n        setNotify((prevState) => ({\n          ...prevState,\n          ...{\n            type: \"danger\",\n            message: error.message,\n            isNotify: true,\n          },\n        }));\n      })\n      .finally(() => {\n        // GO TO HOME:\n        route(`${PREACT_APP_PUBLIC_PATH}`);\n      });\n  };\n\n  useEffect(() => {\n    // FIND INDEX OF PRODUCT:\n    const isMatchIndex = productsDetailData.current?.findIndex(\n      ({ productId }) => productId === id\n    );\n    if (\n      !productsDetailData.current ||\n      isMatchIndex === -1 ||\n      getTime(new Date()) >\n        productsDetailData.current[isMatchIndex]?.timeControl\n    ) {\n      getProductByIdPdp(id)\n        .then((data) => {\n          const timeControl = getTime(addHours(new Date(), 1)); // CONTROL EPISODE API TIME 1 HRS.\n          const newDataForStorage = [\n            ...(productsDetailData.current || []),\n            ...[\n              {\n                timeControl,\n                productId: id,\n                dataProduct: data,\n              },\n            ],\n          ];\n          // SET DATA IN LOCALSTORAGE:\n          window.localStorage.setItem(\n            \"DATA_PRODUCTS_DETAIL_STORE\",\n            JSON.stringify(newDataForStorage)\n          );\n          // SET DATA PRODUCT IN STATE:\n          setProducDetail(data);\n        })\n        .catch((error) => {\n          // SET NOTIFY:\n          setNotify((prevState) => ({\n            ...prevState,\n            ...{\n              type: \"danger\",\n              message: error.message,\n              isNotify: true,\n            },\n          }));\n          // GO TO HOME:\n          route(`${PREACT_APP_PUBLIC_PATH}`);\n        });\n      return;\n    }\n    setTimeout(() => {\n      // SET DATA PRODUCT IN STATE:\n      setProducDetail(productsDetailData.current[isMatchIndex]?.dataProduct);\n    }, 500);\n  }, [id, setNotify]);\n  return (\n    <>\n      {!isObjectEmpty(productDetail) && (\n        <div className={style.pdp}>\n          <section>\n            <div className=\"px-10 py-10 mx-auto\">\n              <div className=\"mx-auto flex flex-wrap justify-between\">\n                <Image\n                  {...{\n                    wrapperClass:\n                      \"!flex flex-col justify-center items-center md:w-1/2 w-full\",\n                    delayTime: 1000,\n                    effect: \"blur\",\n                    imgUrl: productDetail?.imgUrl || \"\",\n                    id: productDetail?.id || \"\",\n                  }}\n                />\n                <div className=\"md:w-1/2 w-full lg:pl-10 lg:py-6 mt-6 lg:mt-0\">\n                  <PdpDescription {...productDetail} />\n                  <PdpAction\n                    handleAddProductToCart={handleAddProductToCart}\n                    {...productDetail}\n                  />\n                </div>\n              </div>\n            </div>\n          </section>\n        </div>\n      )}\n      {isObjectEmpty(productDetail) && <Loader />}\n    </>\n  );\n};\n\nexport default Pdp;\n"],"sourceRoot":""}